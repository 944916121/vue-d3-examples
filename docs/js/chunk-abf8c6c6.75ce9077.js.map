{"version":3,"sources":["webpack:///./node_modules/core-js/modules/_string-html.js","webpack:///./src/components/ForceBasedLabelPlacementIII.vue?2e5a","webpack:///./node_modules/core-js/modules/web.dom.iterable.js","webpack:///./node_modules/core-js/modules/es6.string.link.js","webpack:///./src/components/ForceBasedLabelPlacementIII.vue?ed18","webpack:///src/components/ForceBasedLabelPlacementIII.vue","webpack:///./src/components/ForceBasedLabelPlacementIII.vue?63bb","webpack:///./src/components/ForceBasedLabelPlacementIII.vue?2623"],"names":["$export","fails","defined","quot","createHTML","string","tag","attribute","value","S","String","p1","replace","module","exports","NAME","exec","O","P","F","test","toLowerCase","split","length","$iterators","getKeys","redefine","global","hide","Iterators","wks","ITERATOR","TO_STRING_TAG","ArrayValues","Array","DOMIterables","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","collections","i","key","explicit","Collection","proto","prototype","url","this","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","staticRenderFns","name","data","color","graph","label","labelLayout","graphLayout","width","height","adjlist","svg","container","link","node","labelNode","mounted","d3","nodes","forEach","d","self","push","links","source","target","index","append","call","attr","restart","setTimeout","methods","exit","remove","enter","id","merge","force","ticked","updateNode","updateLink","each","shiftX","Math","max","b","min","setAttribute","fixna","shiftY","x","y","isFinite","component"],"mappings":"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","file":"js/chunk-abf8c6c6.75ce9077.js","sourcesContent":["var $export = require('./_export');\nvar fails = require('./_fails');\nvar defined = require('./_defined');\nvar quot = /\"/g;\n// B.2.3.2.1 CreateHTML(string, tag, attribute, value)\nvar createHTML = function (string, tag, attribute, value) {\n  var S = String(defined(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + String(value).replace(quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\nmodule.exports = function (NAME, exec) {\n  var O = {};\n  O[NAME] = exec(createHTML);\n  $export($export.P + $export.F * fails(function () {\n    var test = ''[NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  }), 'String', O);\n};\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ForceBasedLabelPlacementIII.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ForceBasedLabelPlacementIII.vue?vue&type=style&index=0&lang=css&\"","var $iterators = require('./es6.array.iterator');\nvar getKeys = require('./_object-keys');\nvar redefine = require('./_redefine');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar wks = require('./_wks');\nvar ITERATOR = wks('iterator');\nvar TO_STRING_TAG = wks('toStringTag');\nvar ArrayValues = Iterators.Array;\n\nvar DOMIterables = {\n  CSSRuleList: true, // TODO: Not spec compliant, should be false.\n  CSSStyleDeclaration: false,\n  CSSValueList: false,\n  ClientRectList: false,\n  DOMRectList: false,\n  DOMStringList: false,\n  DOMTokenList: true,\n  DataTransferItemList: false,\n  FileList: false,\n  HTMLAllCollection: false,\n  HTMLCollection: false,\n  HTMLFormElement: false,\n  HTMLSelectElement: false,\n  MediaList: true, // TODO: Not spec compliant, should be false.\n  MimeTypeArray: false,\n  NamedNodeMap: false,\n  NodeList: true,\n  PaintRequestList: false,\n  Plugin: false,\n  PluginArray: false,\n  SVGLengthList: false,\n  SVGNumberList: false,\n  SVGPathSegList: false,\n  SVGPointList: false,\n  SVGStringList: false,\n  SVGTransformList: false,\n  SourceBufferList: false,\n  StyleSheetList: true, // TODO: Not spec compliant, should be false.\n  TextTrackCueList: false,\n  TextTrackList: false,\n  TouchList: false\n};\n\nfor (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {\n  var NAME = collections[i];\n  var explicit = DOMIterables[NAME];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  var key;\n  if (proto) {\n    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);\n    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n    Iterators[NAME] = ArrayValues;\n    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);\n  }\n}\n","'use strict';\n// B.2.3.10 String.prototype.link(url)\nrequire('./_string-html')('link', function (createHTML) {\n  return function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  };\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"force-base-iii\"},[_c('h2',[_vm._v(\"Force-based label placement III\")]),_c('svg',{staticClass:\"container-border\",attrs:{\"id\":\"viz\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"force-base-iii\">\n    <h2>Force-based label placement III</h2>\n    <svg id=\"viz\" class=\"container-border\"></svg>\n  </div>\n</template>\n\n<script>\nimport * as d3 from 'd3'\nimport jsonData from '../assets/json/simple_force_layout.json'\n// import jsonData from '../assets/json/simple_force_layout_2.json' // 金融数据\n// import jsonData from '../assets/json/simple_force_layout_3.json' // 新基建数据\nexport default {\n  name: 'ForceBasedLabelPlacement',\n  data () {\n    return {\n      color: null,\n      graph: null,\n      label: null,\n      labelLayout: null,\n      graphLayout: null,\n      width: 1250,\n      height: 800,\n      adjlist: [],\n      svg: null,\n      container: null,\n      link: null,\n      node: null,\n      labelNode: null\n    }\n  },\n  mounted () {\n    let self = this\n    this.color = d3.scaleOrdinal(d3.schemeCategory10)\n    this.graph = jsonData\n    this.label = {\n      'nodes': [],\n      'links': []\n    }\n    this.graph.nodes.forEach(function (d, i) {\n      self.label.nodes.push({ node: d })\n      self.label.nodes.push({ node: d })\n      self.label.links.push({\n        source: i * 2,\n        target: i * 2 + 1\n      })\n    })\n\n    this.graphLayout = d3.forceSimulation(this.graph.nodes)\n      .force('charge', d3.forceManyBody().strength(-500))\n      .force('x', d3.forceX(this.width / 2))\n      .force('y', d3.forceY(this.height / 2))\n      .force('link', d3.forceLink(this.graph.links).id(function (d) { return d.id }).distance(100))\n      .on('tick', self.ticked)\n\n    this.graph.links.forEach(function (d) {\n      self.adjlist[d.source.index + '-' + d.target.index] = true\n      self.adjlist[d.target.index + '-' + d.source.index] = true\n    })\n\n    this.svg = d3.select('#viz').attr('width', this.width).attr('height', this.height)\n    this.container = this.svg.append('g')\n\n    this.svg.call(\n      d3.zoom()\n        .scaleExtent([1.6 / 2, 4])\n        .on('zoom', function () {\n          self.container.attr('transform', d3.event.transform)\n        })\n    )\n\n    this.link = this.container.append('g').attr('class', 'links')\n      .selectAll('line')\n\n    self.node = this.container.append('g').attr('class', 'nodes')\n      .selectAll('g')\n\n    this.labelNode = this.container.append('g').attr('class', 'labelNodes')\n      .selectAll('text')\n\n    this.restart()\n\n    setTimeout(() => {\n      let addData = [{ 'id': 'Four', 'group': 4 }, { 'id': 'Five', 'group': 5 }]\n      let addLinks = [{ 'source': 'Four', 'target': 'Five', 'value': 3 }, { 'source': 'Five', 'target': 'Feuilly', 'value': 4 }]\n      this.graph.nodes = [...this.graph.nodes, ...addData]\n      this.graph.links = [...this.graph.links, ...addLinks]\n      this.restart()\n    }, 1000)\n  },\n  methods: {\n    restart () {\n      let self = this\n      this.node = this.node.data(this.graph.nodes, function (d) { return d.id })\n      this.node.exit().remove()\n      this.node = this.node.enter().append('circle').attr('fill', function (d) {\n        return self.color(d.id)\n      }).attr('r', 5).merge(this.node)\n\n      this.link = this.link.data(this.graph.links, function (d) {\n        return d.source.id + '-' + d.target.id\n      })\n      this.link.exit().remove()\n      this.link = this.link.enter().append('line').merge(this.link)\n      this.labelNode = this.labelNode.data(this.graph.nodes, function (d) {\n        return d.id\n      })\n      this.labelNode.exit().remove()\n      this.labelNode = this.labelNode.enter().append('text').merge(this.labelNode)\n        .text(function (d) {\n          return d.id\n        })\n        .style('fill', '#555')\n        .style('font-size', 12)\n        .style('pointer-events', 'none')\n\n      this.graphLayout.nodes(this.graph.nodes)\n      this.graphLayout.force('link').links(this.graph.links)\n    },\n    ticked () {\n      let self = this\n      self.node.call(self.updateNode)\n      self.link.call(self.updateLink)\n\n      self.labelNode.each(function (d, i) {\n        if (i % 2 === 0) {\n          // d.x = d.x\n          // d.y = d.y\n        } else {\n          let b = this.getBBox()\n          let diffX = d.x - d.x\n          let diffY = d.y - d.y\n\n          let dist = Math.sqrt(diffX * diffX + diffY * diffY)\n\n          let shiftX = b.width * (diffX - dist) / (dist * 2)\n          shiftX = Math.max(-b.width, Math.min(0, shiftX))\n          let shiftY = 16\n          this.setAttribute('transform', 'translate(' + self.fixna(shiftX) + ',' + shiftY + ')')\n        }\n      })\n      self.labelNode.call(self.updateNode)\n    },\n    updateLink () {\n      let self = this\n      self.link.attr('x1', function (d) { return self.fixna(d.source.x) })\n        .attr('y1', function (d) { return self.fixna(d.source.y) })\n        .attr('x2', function (d) { return self.fixna(d.target.x) })\n        .attr('y2', function (d) { return self.fixna(d.target.y) })\n    },\n    updateNode (node) {\n      let self = this\n      node.attr('transform', function (d) {\n        return 'translate(' + self.fixna(d.x) + ',' + self.fixna(d.y) + ')'\n      })\n    },\n    fixna (x) {\n      if (isFinite(x)) return x\n      return 0\n    }\n  }\n}\n</script>\n<style>\n.force-base-iii .links line {\n  stroke: #999;\n  stroke-opacity: 0.6;\n}\n\n.force-base-iii .nodes circle {\n  stroke: black;\n  stroke-width: 0px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ForceBasedLabelPlacementIII.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ForceBasedLabelPlacementIII.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ForceBasedLabelPlacementIII.vue?vue&type=template&id=66ccd892&\"\nimport script from \"./ForceBasedLabelPlacementIII.vue?vue&type=script&lang=js&\"\nexport * from \"./ForceBasedLabelPlacementIII.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ForceBasedLabelPlacementIII.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}